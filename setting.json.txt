{
    //================================================================
    // 全般設定 (General Settings)
    //================================================================
    "workbench.iconTheme": "vscode-icons",
    "workbench.colorTheme": "GitHub Dark Dimmed",
    "workbench.editorAssociations": {
        "*.copilotmd": "vscode.markdown.preview.editor",
        "*.ts": "default"
    },
    "files.autoSave": "afterDelay",
    "files.associations": {
        "*.f90": "fortran",
        "*.ts": "typescript"
    },
    // [推奨] 信頼されていないファイルを開く際の動作。'open'は危険なため'prompt'に変更。
    "security.workspace.trust.untrustedFiles": "prompt",
    "liveServer.settings.donotShowInfoMsg": true,
    "liveServer.settings.AdvanceCustomBrowserCmdLine": "",
    "json.schemas": [],

    //================================================================
    // エディタ設定 (Editor Settings)
    //================================================================
    "editor.wordWrap": "on",
    "editor.foldingImportsByDefault": true,
    "editor.foldingStrategy": "indentation",
    "editor.insertSpaces": false, // グローバルではタブを使用
    "editor.formatOnSave": true,
    "diffEditor.ignoreTrimWhitespace": false,
    "diffEditor.codeLens": true,

    //================================================================
    // バージョン管理 (Version Control)
    //================================================================
    "git.autofetch": true,
    "git.enableSmartCommit": true,
    "git.confirmSync": false,

    //================================================================
    // ターミナル & 実行 (Terminal & Execution)
    //================================================================
    "terminal.integrated.commandsToSkipShell": [
        "matlab.interrupt"
    ],
    "code-runner.runInTerminal": true,

    //================================================================
    // 言語別設定 (Language Specific Settings)
    //================================================================
    "[latex]": {
        "editor.suggest.snippetsPreventQuickSuggestions": false,
        "editor.tabSize": 2,
        "editor.wordWrap": "on",
        "editor.insertSpaces": true, // LaTeXではスペースを使用
        "editor.detectIndentation": false,
        "editor.suggestSelection": "recentlyUsedByPrefix",
        "editor.quickSuggestions": {
            "other": true,
            "comments": false,
            "strings": false
        },
        "editor.bracketPairColorization.enabled": true,
        "editor.unicodeHighlight.invisibleCharacters": true,
        "editor.unicodeHighlight.allowedCharacters": {
            "，": true, "．": true, "！": true, "？": true, "［": true, "］": true,
            "｛": true, "｝": true, "＜": true, "＞": true
        },
        "editor.stickyScroll.enabled": true
    },
    "[tex]": {
        "editor.suggest.snippetsPreventQuickSuggestions": false,
        "editor.tabSize": 2
    },
    "[bibtex]": {
        "editor.tabSize": 2
    },
    "[fortran]": {
        "editor.semanticHighlighting.enabled": true
    },

    //================================================================
    // 拡張機能別設定 (Extension Specific Settings)
    //================================================================

    //--- C/C++ ---
    // [非推奨] "Tag Parser"は古い設定です。削除してデフォルトのIntelliSenseエンジンを使用することを推奨します。
    // "C_Cpp.intelliSenseEngine": "Tag Parser",

    //--- Arduino ---
    "arduino.ignoreBoards": [],
    "arduino.commandPath": "arduino-cli.exe",
    "arduino.path": "C:\\Program Files\\Arduino CLI",
    "arduino.useArduinoCli": true,

    //--- CMake ---
    "cmake.pinnedCommands": [
        "workbench.action.tasks.configureTaskRunner",
        "workbench.action.tasks.runTask"
    ],

    //--- Spell Checker ---
    "cSpell.userWords": [
        "bigend", "biggend", "DFPLAYER", "dfrobot", "Hagman", "hserial",
        "intrabit", "ladyada", "maskreg", "maskvalue", "Mikal", "pcint",
        "pico", "PROGMEM", "raspberrypi", "sserial", "Stoffregen",
        "stopbit", "thebuf"
    ],

    //--- GitHub Copilot & AI Tools ---
    "github.copilot.nextEditSuggestions.enabled": true,
    "github.copilot.enable": {
        "*": true,
        "plaintext": false,
        "markdown": true,
        "scminput": false
    },
    "dart.flutterSdkPath": "C:\\Users\\kaito\\flutter",
    "geminicodeassist.project": "xanthic-renderer-k1tnf",
    "chat.agent.maxRequests": 40,
    "chat.tools.autoApprove": true, // UI上のツール使用は自動承認
    "chat.tools.terminal.autoReplyToPrompts": true,

    // [重要/セキュリティ] ターミナルコマンドの自動承認設定。
    // 汎用コマンド(python, node, mkdir等)の自動承認は極めて危険なため、すべて無効化しました。
    // 信頼できる特定のスクリプトのみを、以下のようにフルパスで指定して承認することを強く推奨します。
    "chat.tools.terminal.autoApprove": {

    },

    //--- LaTeX Workshop ---
    // 出力ディレクトリ。(.gitignoreに "%DIR%/out" を追加することを推奨)
    "latex-workshop.latex.outDir": "%DIR%/out",
    // ビルドツールチェインの定義
    "latex-workshop.latex.tools": [
        { "name": "Latexmk (LuaLaTeX)", "command": "latexmk", "args": [ "-f", "-gg", "-pv", "-lualatex", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "-output-directory=%OUTDIR%", "%DOC%" ] },
        { "name": "Latexmk (XeLaTeX)", "command": "latexmk", "args": [ "-f", "-gg", "-pv", "-xelatex", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "-output-directory=%OUTDIR%", "%DOC%" ] },
        { "name": "Latexmk (upLaTeX)", "command": "latexmk", "args": [ "-f", "-gg", "-pv", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "-output-directory=%OUTDIR%", "%DOC%" ] },
        { "name": "Latexmk (pLaTeX)", "command": "latexmk", "args": [ "-f", "-gg", "-pv", "-latex='platex'", "-latexoption='-kanji=utf8 -no-guess-input-env'", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "-output-directory=%OUTDIR%", "%DOC%" ] }
    ],
    // ビルドレシピの定義 (デフォルトは最初のもの)
    "latex-workshop.latex.recipes": [
        { "name": "LuaLaTeX", "tools": [ "Latexmk (LuaLaTeX)" ] },
        { "name": "XeLaTeX", "tools": [ "Latexmk (XeLaTeX)" ] },
        { "name": "upLaTeX", "tools": [ "Latexmk (upLaTeX)" ] },
        { "name": "pLaTeX", "tools": [ "Latexmk (pLaTeX)" ] }
    ],
    // ファイル保存時の自動ビルドは無効 (ユーザー設定を維持)
    "latex-workshop.latex.autoBuild.run": "never",
    // ビルド成功時に中間ファイルを削除
    "latex-workshop.latex.autoClean.run": "onBuilt",
    "latex-workshop.latex.clean.method": "glob",
    "latex-workshop.latex.clean.fileTypes": [
        "*.aux", "*.bbl", "*.blg", "*.idx", "*.ind", "*.lof", "*.lot", "*.out",
        "*.toc", "*.acn", "*.acr", "*.alg", "*.glg", "*.glo", "*.gls", "*.ist",
        "*.fls", "*.log", "*.fdb_latexmk", "*.synctex.gz", "_minted*", "*.nav",
        "*.snm", "*.vrb", "*.figlist", "*.makefile", "*.run.xml", "*.bcf",
        "*.ilg", "*.nlo", "*.nls", "*.auxlock"
    ],
    // PDFビューワはタブで開く
    "latex-workshop.view.pdf.viewer": "tab",
    // パッケージコマンドの補完を有効化
    "latex-workshop.intellisense.package.enabled": true,
    // マジックコメント用の設定
    "latex-workshop.latex.magic.args": [
        "-f", "-gg", "-pv", "-synctex=1", "-interaction=nonstopmode",
        "-file-line-error", "%DOC%"
    ]
}