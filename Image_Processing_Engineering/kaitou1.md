
---

### 1. この問題の目的と基本方針

この問題は、複数のレンズを組み合わせた光学系（複合レンズ系）において、物体が最終的にどのような像として結ばれるかを理解することが目的です。

現実のカメラのレンズや望遠鏡、顕微鏡などは、複数のレンズを組み合わせて性能を高めています。この問題は、その最も基本的なモデルを解くことにあたります。

解法の基本方針は、レンズごとに問題を分割して考えることです。

1.  まず、物体に最も近い凸レンズAによって、どのような像（これを中間像と呼びます）ができるかを計算します。
2.  次に、この中間像を、凸レンズBにとっての新しい物体と見なして、最終的にできる像の位置と大きさを計算します。

このように、一つずつ順番に光の進路を追っていくことで、複雑な光学系の問題も解くことができます。

### 2. 計算の前に：用語と公式の解説

計算に使う重要な用語と公式の意味を先に確認します。

#### 用語解説

*   凸レンズ (Convex Lens)
    中央部分が厚くなっているレンズで、光軸に平行な光を集める性質（収束作用）があります。
*   焦点距離 (Focal Length) $f$
    レンズの最も基本的な性能を表す値です。レンズの軸に平行に入射した光が、レンズを通過した後に集まる一点（焦点）からレンズ中心までの距離を指します。凸レンズの焦点距離は、符号を正 ($+$) として扱います。
*   物体距離 (Object Distance) $a$
    レンズの中心から、観測したい物体までの距離です。光が進んでくる方向（通常はレンズの前方）に物体があるので、符号は正 ($+$) です。
*   像距離 (Image Distance) $b$
    レンズの中心から、像が結ばれる位置までの距離です。
    *   実像 (Real Image): レンズを通過した光が実際に集まってできる像です。スクリーンを置けば像を映し出すことができます。このとき、像距離 $b$ の符号は正 ($+$) となります。
    *   虚像 (Virtual Image): レンズを通過した光が、ある一点から広がって出てくるように見える位置にできる像です。スクリーンには映りません。このとき、像距離 $b$ の符号は負 ($-$) となります。
*   倍率 (Magnification) $m$
    元の物体の大きさに対して、像がどれくらいの大きさになるかを示す比率です。

#### 公式解説

*   レンズの公式（写像公式）
    $$
    \frac{1}{a} + \frac{1}{b} = \frac{1}{f}
    $$
    この式は、物体距離 $a$、像距離 $b$、焦点距離 $f$ の間の関係を示す、レンズ光学における最も重要な公式です。これは、光がレンズで屈折する法則（スネルの法則）を、光の角度が小さいという近似（近軸近似）を用いて単純化したもので、「物体の一点から出た光が、レンズを通過した後に、どこに再び一点として集まるか」を計算するために使います。

*   倍率の公式
    $$
    m = -\frac{b}{a}
    $$
    倍率 $m$ は、像距離 $b$ と物体距離 $a$ の比で計算できます。
    *   $|m| > 1$ ならば、像は物体より大きい（拡大）。
    *   $|m| < 1$ ならば、像は物体より小さい（縮小）。
    *   $m$ の符号は像の向きを表します。
        *   $m < 0$ (負) ならば、像は物体に対して上下が逆さまの倒立像です。実像は常に倒立です。
        *   $m > 0$ (正) ならば、像は物体と同じ向きの正立像です。虚像は常に正立です。

### 3. 計算プロセス

それでは、上記の方針と公式に沿って、問題を2つのステップに分けて解いていきます。

---

#### ステップ1：凸レンズAによる中間像の計算

まず、凸レンズBは無いものとして、凸レンズAによってできる像（中間像）の位置、大きさ、向きを求めます。

*   与えられた値
    *   凸レンズAの焦点距離: $f_A = 12 \, \text{cm}$
    *   物体距離: $a_A = 16 \, \text{cm}$
    *   物体の大きさ: $h = 2.0 \, \text{cm}$

*   像距離 $b_A$ の計算
    レンズの公式 $\frac{1}{a_A} + \frac{1}{b_A} = \frac{1}{f_A}$ に値を代入します。
    $$
    \frac{1}{16} + \frac{1}{b_A} = \frac{1}{12}
    $$
    $\frac{1}{b_A}$ について解くと、
    $$
    \frac{1}{b_A} = \frac{1}{12} - \frac{1}{16}
    $$
    通分して計算します（分母を48に揃えます）。
    $$
    \frac{1}{b_A} = \frac{4}{48} - \frac{3}{48} = \frac{1}{48}
    $$
    したがって、像距離 $b_A$ は、
    $$
    b_A = 48 \, \text{cm}
    $$
    $b_A$ が正の値なので、これは実像であり、凸レンズAの後方 48cm の位置にできます。

*   中間像の倍率 $m_A$ と大きさ $h_A'$ の計算
    倍率の公式 $m_A = -\frac{b_A}{a_A}$ を使います。
    $$
    m_A = -\frac{48}{16} = -3
    $$
    $m_A$ が負なので、この中間像は元の物体に対して倒立しています。
    像の大きさ $h_A'$ は、元の物体の大きさに倍率の絶対値を掛けて求めます。
    $$
    h_A' = h \times |m_A| = 2.0 \, \text{cm} \times 3 = 6.0 \, \text{cm}
    $$

*   ステップ1のまとめ
    凸レンズAによって、Aの後方 48cm の位置に、大きさが 6.0cm の倒立した実像（中間像）ができます。

---

#### ステップ2：凸レンズBによる最終的な像の計算

次に、ステップ1で求めた中間像を、凸レンズBにとっての「物体」として扱います。

*   与えられた値
    *   凸レンズBの焦点距離: $f_B = 10 \, \text{cm}$
    *   レンズAとBの間の距離: $L = 63 \, \text{cm}$

*   凸レンズBにとっての物体距離 $a_B$ の計算
    中間像は、凸レンズAから後方 48cm の位置にあります。
    凸レンズBは、凸レンズAから 63cm 離れています。
    したがって、凸レンズBから中間像（新しい物体）までの距離 $a_B$ は、
    $$
    a_B = L - b_A = 63 \, \text{cm} - 48 \, \text{cm} = 15 \, \text{cm}
    $$

*   凸レンズBにとっての物体の大きさ $h_B$
    これは中間像の大きさなので、$h_B = h_A' = 6.0 \, \text{cm}$ です。

*   最終的な像距離 $b_B$ の計算
    再びレンズの公式 $\frac{1}{a_B} + \frac{1}{b_B} = \frac{1}{f_B}$ に値を代入します。
    $$
    \frac{1}{15} + \frac{1}{b_B} = \frac{1}{10}
    $$
    $\frac{1}{b_B}$ について解くと、
    $$
    \frac{1}{b_B} = \frac{1}{10} - \frac{1}{15}
    $$
    通分して計算します（分母を30に揃えます）。
    $$
    \frac{1}{b_B} = \frac{3}{30} - \frac{2}{30} = \frac{1}{30}
    $$
    したがって、最終的な像距離 $b_B$ は、
    $$
    b_B = 30 \, \text{cm}
    $$
    $b_B$ が正の値なので、これも実像であり、凸レンズBの後方 30cm の位置にできます。

*   最終的な像の倍率 $m_B$ と大きさ $h_B'$ の計算
    倍率の公式 $m_B = -\frac{b_B}{a_B}$ を使います。
    $$
    m_B = -\frac{30}{15} = -2
    $$
    $m_B$ が負なので、この像は「凸レンズBにとっての物体（つまり中間像）」に対して倒立しています。
    中間像はすでに倒立していたので、「倒立の倒立」となり、最終的な像は元の物体に対して正立となります。

    最終的な像の大きさ $h_B'$ は、中間像の大きさに倍率 $m_B$ の絶対値を掛けて求めます。
    $$
    h_B' = h_B \times |m_B| = 6.0 \, \text{cm} \times 2 = 12.0 \, \text{cm}
    $$

### 4. 結論

以上の計算結果をまとめます。

*   像の位置: 凸レンズBの後方 30cm
*   像の大きさ: 12.0 cm

補足として、像の種類と向きは以下のようになります。
*   像の種類: 実像
*   像の向き: 元の物体に対して正立
    （総合倍率 $M = m_A \times m_B = (-3) \times (-2) = +6$ となり、符号が正であることからも正立であることが確認できます。）

---

### 1. この問題の目的

この問題は、スマートデバイスやPCモニターなど、仕様の異なるディスプレイの「精細さ」を、ppi (pixels per inch) という客観的な指標を用いて数値化し、比較することを目的としています。

画素数が多く、画面サイズが大きければ高性能に見えますが、実際の表示の滑らかさや鮮明さは、両者のバランスによって決まります。ppiを計算することで、それぞれのデバイスがどのような思想で設計されているのか、また、どのような利用シーンを想定しているのかを深く理解することができます。

### 2. 用語と計算原理の解説

計算に先立ち、関連する用語とppiを算出するための考え方を解説します。

#### 用語解説

*   画面サイズ: ディスプレイの物理的な大きさを表す指標です。一般的に、画面の対角線の長さをインチ ($1 \, \text{inch} \approx 2.54 \, \text{cm}$) 単位で示します。
*   画素 (Pixel): デジタル画像やディスプレイを構成する最小単位の「点」です。ディスプレイは、この光る点の集合体として映像を映し出しています。
*   画素数 (Resolution): ディスプレイがいくつの画素で構成されているかを示す値で、通常は「横方向の画素数 × 縦方向の画素数」で表記されます。例えば、Full HDは $1,920 \times 1,080$ 画素です。
*   ppi (pixels per inch): ディスプレイの画素密度を表す単位です。その名の通り、「1インチあたりに何個の画素が並んでいるか」を示します。この数値が高いほど、画素の粒が細かく、高精細で滑らかな表示が可能になります。

#### 計算の原理

ppiを計算するためには、「画面の対角線1インチあたりに、いくつの画素が並んでいるか」を求めます。しかし、与えられている情報は「横と縦の画素数」と「対角線の物理的な長さ（インチ）」です。

そこで、まず画面の対角線上にいくつの画素が並んでいるのかを、数学的に算出する必要があります。これは、ピタゴラスの定理（三平方の定理）を用いることで解決できます。

横の画素数を $w_p$、縦の画素数を $h_p$ とすると、対角線上の画素数 $d_p$ は、これらを2辺とする直角三角形の斜辺の長さに相当するため、以下の式で求められます。

$$
d_p = \sqrt{w_p^2 + h_p^2}
$$

この対角線上の総画素数 $d_p$ を、物理的な対角線の長さである画面サイズ $d_i$ (インチ) で割ることで、1インチあたりの画素数、すなわちppiが算出できます。

したがって、ppiを計算する公式は以下のようになります。

$$
\text{ppi} = \frac{d_p}{d_i} = \frac{\sqrt{w_p^2 + h_p^2}}{d_i}
$$

### 3. 各デバイスのppi計算

それでは、上記の公式を用いて、各デバイスのppiを計算します。計算の正確性を期すため、ツールを用いて実行します。

#### A. Google Pixel 10

*   画面サイズ ($d_i$): $6.3$ インチ
*   画素数 ($w_p \times h_p$): $1,080 \times 2,424$

$$
\text{ppi} = \frac{\sqrt{1080^2 + 2424^2}}{6.3} = \frac{\sqrt{1166400 + 5875776}}{6.3} = \frac{\sqrt{7042176}}{6.3} \approx \frac{2653.7}{6.3} \approx 421.22
$$

整数値で求めると 421 ppi となります。

#### B. iPad (A16)

*   画面サイズ ($d_i$): $10.9$ インチ
*   画素数 ($w_p \times h_p$): $2,360 \times 1,640$

$$
\text{ppi} = \frac{\sqrt{2360^2 + 1640^2}}{10.9} = \frac{\sqrt{5569600 + 2689600}}{10.9} = \frac{\sqrt{8259200}}{10.9} \approx \frac{2873.9}{10.9} \approx 263.66
$$

整数値で求めると 264 ppi となります。

#### C. EIZO EV2740S

*   画面サイズ ($d_i$): $27.0$ インチ
*   画素数 ($w_p \times h_p$): $3,840 \times 2,160$ (4K UHD)

$$
\text{ppi} = \frac{\sqrt{3840^2 + 2160^2}}{27.0} = \frac{\sqrt{14745600 + 4665600}}{27.0} = \frac{\sqrt{19411200}}{27.0} \approx \frac{4405.8}{27.0} \approx 163.18
$$

整数値で求めると 163 ppi となります。

### 4. 比較と考察

計算結果をまとめると、以下のようになります。

| デバイス名 | ppi (整数値) |
| :--- | :--- |
| Google Pixel 10 | 421 ppi |
| iPad (A16) | 264 ppi |
| EIZO EV2740S | 163 ppi |

この結果から、デバイスの種類によってppiが大きく異なることが明確にわかります。

Google Pixel 10 (スマートフォン) > iPad (タブレット) > EIZO EV2740S (PCモニター)

この序列が生まれる主な理由は、デバイスとユーザーの目との間の標準的な距離、すなわち「視距離」にあります。

*   スマートフォン: 顔の近くで操作するため、視距離が最も短くなります。そのため、画素の粗さが認識されやすく、非常に高い画素密度（ppi）が要求されます。400 ppiを超える高精細ディスプレイは、文字や画像を非常に滑らかに表示します。
*   タブレット: スマートフォンよりは少し離れた距離で、机の上や膝の上で使われることが多いため、スマートフォンほどの超高密度なppiは必要とされません。Apple社が「Retinaディスプレイ」と呼ぶ基準も、iPadではおよそ264 ppi前後であり、通常の利用距離で画素が識別できないレベルとされています。
*   PCモニター: デスク上に設置し、最も遠い距離から見るデバイスです。画面サイズが大きいため、同じ画素数でもppiは低くなる傾向にあります。しかし、視距離が長いため、163 ppiでも十分に高精細な映像として認識され、広大な作業領域を確保するというモニター本来の役割を果たします。

### 5. 結論

各デバイスのppiを計算した結果、Google Pixel 10が421 ppi、iPad (A16)が264 ppi、EIZO EV2740Sが163 ppiとなりました。

この数値の違いは、各デバイスが想定する「ユーザーとの視距離」に最適化された結果です。目に近いスマートフォンは最も精細に、中間的な距離のタブレットがそれに続き、最も遠くから見るPCモニターは画面の広さを優先した設計になっていることが、ppiという客観的な指標から定量的に理解できます。


---

### 1. この問題の目的と基本原理

この問題は、デジタル画像処理における「鮮鋭化（シャープニング）」という処理が、どのような数学的原理に基づいて行われるのかを理解し、その処理を実行するための具体的な計算ツールである「空間フィルタ（オペレータやカーネルとも呼ばれます）」を自ら導出することを目的としています。

#### 鮮鋭化の基本原理

画像の鮮鋭化とは、画像の輪郭や細かい部分を強調し、全体的に「くっきり」させる処理です。この処理の根底には、非常に直感的なアイデアがあります。

鮮鋭化された画像 = 元の画像 + その画像の輪郭（エッジ）成分

つまり、元の画像から輪郭部分だけを抽出し、それを元の画像に足し合わせれば、輪郭がより強調される、という考え方です。

画像処理において、この「輪郭（エッジ）成分」を抽出するための代表的な手法が、ラプラシアンフィルタです。ラプラシアンフィルタは、数学的には2次微分演算子に相当し、画像の輝度が急激に変化する部分（＝エッジ）を検出する能力を持ちます。

この関係を、フィルタオペレータで表現すると、以下のようになります。

鮮鋭化オペレータ = 単位オペレータ - ラプラシアンオペレータ

ここで、
*   鮮鋭化オペレータ ($W_S$): 最終的に求めたい、鮮鋭化処理を行うフィルタ。
*   単位オペレータ ($W_I$): 入力された画像を何も変えずにそのまま出力するフィルタ（「元の画像」に相当）。
*   ラプラシアンオペレータ ($W_L$): 画像からエッジ成分を抽出するフィルタ。

なぜ引き算なのかというと、一般的なラプラシアンフィルタはエッジ部分で輝度を「へこませる（値を小さくする）」効果を持つように設計されます。そのため、元の画像から「へこんだ」エッジ成分を「引き算」すると、結果的にエッジ部分が「盛り上がり（強調される）」ことになるからです。

この基本原理に沿って、順を追って鮮鋭化オペレータを導出します。

### 2. ステップ1： 8近傍ラプラシアンフィルタ ($W_L$) の導出

まず、鮮鋭化の核となる「エッジ成分」を抽出するための8近傍ラプラシアンフィルタを導出します。

ラプラシアンは、ある点における「変化の変化率」の総和として定義されます。画像処理では、これを画素値の差分（変化）の、さらにその差分（変化の変化）として計算します。8近傍では、水平、垂直、そして2つの斜め方向、合計4方向の変化を考慮します。

注目画素の座標を $(i, j)$、その輝度値を $f(i,j)$ とします。

1.  x方向（水平）の2次差分 $f_{xx}$:
    $$
    f_{xx} = \{f(i+1, j) - f(i, j)\} - \{f(i, j) - f(i-1, j)\} = f(i+1, j) - 2f(i, j) + f(i-1, j)
    $$
    これは、「右隣との差」から「左隣との差」を引いたもので、水平方向の変化がどれだけ加速しているかを示します。

2.  y方向（垂直）の2次差分 $f_{yy}$:
    $$
    f_{yy} = \{f(i, j+1) - f(i, j)\} - \{f(i, j) - f(i, j-1)\} = f(i, j+1) - 2f(i, j) + f(i, j-1)
    $$
    同様に、垂直方向の変化の加速率です。

3.  斜め方向1（左上-右下）の2次差分 $f_{d1}$:
    $$
    f_{d1} = \{f(i+1, j+1) - f(i, j)\} - \{f(i, j) - f(i-1, j-1)\} = f(i+1, j+1) - 2f(i, j) + f(i-1, j-1)
    $$

4.  斜め方向2（右上-左下）の2次差分 $f_{d2}$:
    $$
    f_{d2} = \{f(i+1, j-1) - f(i, j)\} - \{f(i, j) - f(i-1, j+1)\} = f(i+1, j-1) - 2f(i, j) + f(i-1, j+1)
    $$

8近傍ラプラシアン $\nabla^2 f(i,j)$ は、これら4方向の2次差分をすべて足し合わせたものです。
$$
\nabla^2 f(i,j) = f_{xx} + f_{yy} + f_{d1} + f_{d2}
$$
上記の4つの式をすべて足し合わせると、各画素の係数が明らかになります。
*   注目画素 $f(i,j)$ の係数は、各式の $-2$ が4回足されるので、$-8$ となります。
*   周囲の8つの画素（$f(i\pm1, j)$, $f(i, j\pm1)$, $f(i\pm1, j\pm1)$）は、それぞれ1回ずつ登場するので、係数はすべて $+1$ となります。

したがって、$\nabla^2 f(i,j)$ は以下の式で表されます。
$$
\begin{aligned}
\nabla^2 f(i,j) = & \quad f(i-1, j-1) + f(i-1, j) + f(i-1, j+1) \\
& + f(i, j-1) \quad - 8f(i, j) \quad + f(i, j+1) \\
& + f(i+1, j-1) + f(i+1, j) + f(i+1, j+1)
\end{aligned}
$$
この計算は、3x3のフィルタオペレータと画像の畳み込み演算に相当します。各画素の係数をそのままオペレータの対応する位置に配置すると、8近傍ラプラシアンオペレータ $W_L$ が得られます。

$$
W_L =
\begin{pmatrix}
1 & 1 & 1 \\
1 & -8 & 1 \\
1 & 1 & 1
\end{pmatrix}
$$

### 3. ステップ2： 8近傍鮮鋭化フィルタ ($W_S$) の導出

次に、ステップ1で求めたラプラシアンオペレータ $W_L$ を用いて、本題である鮮鋭化オペレータ $W_S$ を導出します。
基本原理の式を再掲します。

$$
W_S = W_I - W_L
$$

この計算には、単位オペレータ $W_I$ が必要です。単位オペレータは、フィルタを適用しても画像が全く変化しない、つまり $g(i,j) = f(i,j)$ となるものです。これを実現するには、注目画素 $f(i,j)$ の係数のみが $1$ で、他のすべての係数が $0$ であればよいため、以下のようになります。

$$
W_I =
\begin{pmatrix}
0 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 0
\end{pmatrix}
$$

準備が整ったので、行列の引き算を実行します。

$$
W_S =
\begin{pmatrix}
0 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 0
\end{pmatrix}
-
\begin{pmatrix}
1 & 1 & 1 \\
1 & -8 & 1 \\
1 & 1 & 1
\end{pmatrix}
$$

行列の各要素について、それぞれ引き算を行います。

$$
W_S =
\begin{pmatrix}
(0 - 1) & (0 - 1) & (0 - 1) \\
(0 - 1) & (1 - (-8)) & (0 - 1) \\
(0 - 1) & (0 - 1) & (0 - 1)
\end{pmatrix}
=
\begin{pmatrix}
-1 & -1 & -1 \\
-1 & 9 & -1 \\
-1 & -1 & -1
\end{pmatrix}
$$

### 4. 結論

以上の導出過程を経て、図A-2で示された8近傍鮮鋭化フィルタのオペレータが得られました。

$$
\text{8近傍鮮鋭化オペレータ} \ W_S =
\begin{pmatrix}
-1 & -1 & -1 \\
-1 & 9 & -1 \\
-1 & -1 & -1
\end{pmatrix}
$$

このオペレータは、注目画素の値を9倍し、その周囲8画素の値をすべて引き算するという処理を行います。これにより、周囲との輝度差がほとんどない平坦な領域では値の変化が相殺されて小さくなり、輝度差の大きいエッジ部分ではその差が強調されるため、結果として画像が鮮鋭化されます。

ご提示いただいた、Sobelフィルタを用いたエッジ検出の問題について、その背景にある原理や用語の意味から、具体的な計算手順、そして結果の解釈までを詳細に解説します。

***

### **1. この問題の目的とSobelフィルタの原理**

この問題は、デジタル画像処理における最も基本的なタスクの一つである「エッジ検出」を、Sobelフィルタという代表的な手法を用いて体験し、その計算プロセスを理解することを目的としています。

画像における「エッジ」とは、画素の値（輝度）が急激に変化する境界部分を指します。Sobelフィルタは、この輝度の変化率、すなわち「勾配」を計算することでエッジを検出します。

#### **Sobelフィルタの原理**

Sobelフィルタは、数学的には一次微分を近似する演算子です。画像の特定の点（注目画素）において、水平方向（x方向）と垂直方向（y方向）の輝度変化の度合いを別々に計算します。

*   **x方向の微分 ($G_x$)**: 画像を横切る方向の輝度変化を捉えます。これにより、垂直方向のエッジ（縦線）が強く検出されます。
*   **y方向の微分 ($G_y$)**: 画像を縦断する方向の輝度変化を捉えます。これにより、水平方向のエッジ（横線）が強く検出されます。

この計算のために、以下の2種類の3x3のフィルタ（カーネルまたはオペレータとも呼ばれます）を使用します。

**x方向のSobelフィルタ ($S_x$)**
$$
S_x =
\begin{pmatrix}
-1 & 0 & 1 \\
-2 & 0 & 2 \\
-1 & 0 & 1
\end{pmatrix}
$$
このフィルタは、右側の列から左側の列の値を引き算することで、水平方向の変化を計算します。中央の行の重みが2倍になっているのは、注目画素の行をより重視し、同時にノイズの影響を低減する平滑化の効果を持たせるためです。

**y方向のSobelフィルタ ($S_y$)**
$$
S_y =
\begin{pmatrix}
-1 & -2 & -1 \\
0 & 0 & 0 \\
1 & 2 & 1
\end{pmatrix}
$$
同様に、下の行から上の行の値を引き算することで、垂直方向の変化を計算します。

#### **エッジの強度と方向**

$G_x$と$G_y$が計算できれば、それらをベクトルとして合成することで、エッジの総合的な「強さ」と「向き」を求めることができます。

*   **エッジの強度 (Magnitude) $G$**: 勾配ベクトルの大きさに相当し、エッジがどれだけ「急峻」であるかを示します。値が大きいほど、より明確なエッジであることを意味します。
    $$
    G = \sqrt{G_x^2 + G_y^2}
    $$

*   **エッジの方向 (Direction) $\theta$**: 勾配ベクトルの向きに相当し、輝度値が最も急激に増加する方向を示します。エッジの線自体は、この勾配の方向と直交する向きに延びています。
    $$
    \theta = \arctan\left(\frac{G_y}{G_x}\right)
    $$

### **2. 計算プロセス**

それでは、上記で解説した原理と式を用いて、注目画素AとBについて計算を進めます。計算の正確性を期すため、ツールを用いて実行します。

---

#### **注目画素 A の計算**

注目画素A（値50）を中心とする3x3領域は以下の通りです。
$$
\text{Image}_A =
\begin{pmatrix}
50 & 50 & 100 \\
50 & 50 & 100 \\
100 & 100 & 150
\end{pmatrix}
$$

1.  **x方向の一次微分 $G_x$ の計算**
    $G_x = (50 \times -1 + 50 \times 0 + 100 \times 1) + (50 \times -2 + 50 \times 0 + 100 \times 2) + (100 \times -1 + 100 \times 0 + 150 \times 1)$
    $G_x = (-50 + 100) + (-100 + 200) + (-100 + 150)$
    $G_x = 50 + 100 + 50 = 200$

2.  **y方向の一次微分 $G_y$ の計算**
    $G_y = (50 \times -1 + 50 \times -2 + 100 \times -1) + (50 \times 0 + 50 \times 0 + 100 \times 0) + (100 \times 1 + 100 \times 2 + 150 \times 1)$
    $G_y = (-50 - 100 - 100) + (0) + (100 + 200 + 150)$
    $G_y = -250 + 450 = 200$

3.  **エッジの強度 $G$ の計算**
    $G_A = \sqrt{G_x^2 + G_y^2} = \sqrt{200^2 + 200^2} = \sqrt{40000 + 40000} = \sqrt{80000} \approx 282.84$

4.  **エッジの方向 $\theta$ の計算**
    $\theta_A = \arctan\left(\frac{G_y}{G_x}\right) = \arctan\left(\frac{200}{200}\right) = \arctan(1) = 45^\circ$

---

#### **注目画素 B の計算**

注目画素B（値150）を中心とする3x3領域は以下の通りです。
$$
\text{Image}_B =
\begin{pmatrix}
150 & 250 & 250 \\
150 & 150 & 250 \\
100 & 100 & 200
\end{pmatrix}
$$

1.  **x方向の一次微分 $G_x$ の計算**
    $G_x = (150 \times -1 + 250 \times 0 + 250 \times 1) + (150 \times -2 + 150 \times 0 + 250 \times 2) + (100 \times -1 + 100 \times 0 + 200 \times 1)$
    $G_x = (-150 + 250) + (-300 + 500) + (-100 + 200)$
    $G_x = 100 + 200 + 100 = 400$

2.  **y方向の一次微分 $G_y$ の計算**
    $G_y = (150 \times -1 + 250 \times -2 + 250 \times -1) + (150 \times 0 + 150 \times 0 + 250 \times 0) + (100 \times 1 + 100 \times 2 + 200 \times 1)$
    $G_y = (-150 - 500 - 250) + (0) + (100 + 200 + 200)$
    $G_y = -900 + 500 = -400$

3.  **エッジの強度 $G$ の計算**
    $G_B = \sqrt{G_x^2 + G_y^2} = \sqrt{400^2 + (-400)^2} = \sqrt{160000 + 160000} = \sqrt{320000} \approx 565.69$

4.  **エッジの方向 $\theta$ の計算**
    $\theta_B = \arctan\left(\frac{G_y}{G_x}\right) = \arctan\left(\frac{-400}{400}\right) = \arctan(-1) = -45^\circ$

### **3. 比較と考察**

計算結果を以下にまとめます。

| | 注目画素 A | 注目画素 B |
| :--- | :--- | :--- |
| **x方向微分 $G_x$** | 200 | 400 |
| **y方向微分 $G_y$** | 200 | -400 |
| **エッジ強度 $G$** | 約 282.8 | 約 565.7 |
| **エッジ方向 $\theta$** | 45° | -45° |

この結果を比較し、考察します。

*   **エッジの強度について**
    注目画素Bのエッジ強度（約565.7）は、注目画素Aのエッジ強度（約282.8）の約2倍です。これは、画素Bの周辺における輝度値の変化が、画素Aの周辺よりもはるかに急峻であることを示しています。
    実際に画像を見ると、Aの周辺では輝度差が50程度（例: 50→100）であるのに対し、Bの周辺では輝度差が100程度（例: 150→250）となっており、計算結果が視覚的な印象と一致していることがわかります。

*   **エッジの方向について**
    *   **注目画素A**: エッジの方向は45°です。これは、輝度値が「左下から右上」に向かって最も急激に増加することを意味します。エッジの線自体は、この勾配方向と直交するため、「左上から右下」に向かって走る斜めのエッジであることが示唆されます。
    *   **注目画素B**: エッジの方向は-45°です。これは、輝度値が「左上から右下」に向かって最も急激に増加することを意味します。したがって、エッジの線は「左下から右上」に向かう斜めのエッジであると解釈できます。

### **4. 結論**

Sobelフィルタを適用することで、画像内の各点におけるエッジの特性を定量的に評価することができました。

*   **一次微分 ($G_x, G_y$)**: 画像の水平・垂直方向の輝度変化を数値化しました。
*   **エッジ強度 ($G$)**: 輝度変化の大きさを表し、画素Bが画素Aよりも強いエッジ上にあることを明らかにしました。
*   **エッジ方向 ($\theta$)**: 輝度変化の向きを示し、両画素がそれぞれ異なる向きの斜めエッジ上にあることを特定しました。

このように、Sobelフィルタは画像の構造を理解し、特徴を抽出するための強力なツールであることがわかります。