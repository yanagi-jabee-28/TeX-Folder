# **PCM通信テキスト**

## **1 目的**

実機デモとシミュレータでの回路作成を通じて、アナログ信号をパルス信号で変調、復調するパルス符号変・復調回路の仕組みと、その動作を習得することを目的として本実験を実施した。

## **2 原理**

### **2.1 パルス符号・復調**

図1にPCM変・復調回路の基本方式を示す。PCM変調回路は、図1に示すように入力切換回路で選択された入力信号を、標本化パルスにより標本化する標本化回路、標本化された入力信号を量子化レベルに変換する量子化回路、量子化レベルを2進符号化信号に変換する符号化回路、および同期信号、チャンネル信号を挿入して送信する送信回路より構成されている。

また、PCM復調回路は、受信信号のチャンネル信号とPCM変調信号を分離する分離回路、分離されたチャンネル信号を解読するチャンネル判別回路、PCM変調信号を並列信号に変換する符号変換回路、並列信号に変換されたPCM変調信号をチャンネル別に復調するD/A変換器、および高周波成分を除去するLPF回路より構成されている。

### **2.2 タイミングパルス発生回路**

タイミングパルス発生回路は1つの発振器をもとにして、装置各部の回路に必要なタイミングパルスを発生する回路である。タイミングパルス発生回路の回路図を図2に示す。

U3 SN74LS162のCLKには、U1の125 [kHz]のクロックパルスが入力されている。U3 SN74LS162はこのパルスをカウントし、一定の数をカウントしたらRCOから信号が出力される（キャリーオーバーCOが出力されるという）。図2では、RCOの信号がJKフリップフロップ回路に出力されるようになっている。

図2のJKフリップフロップ回路において、JとKのどちらもHighレベルが入力されているので、JKフリップフロップ回路の1番に信号が入力されると現在の出力Qを反転して出力する。JKフリップフロップ回路の1番にはRCOが入力されているので、U1のクロックパルスが一定数カウントされてRCOから信号が出力されるとQが反転するということである。なお、QはT1として出力されている。

### **2.3 切換回路**

PCM通信を多重化するための切換回路を図3に示す。この場合上と下に2チャンネルの入力信号源がある。この回路出力は標本化回路の入力となる。

図3では、U1のクロックによってSW3とSW4のスイッチが切り替えられる。クロックがLowレベルのときSW3のスイッチがON、SW4のスイッチがOFFとなり、上の信号源（50 [Hz]の正弦波）がVoutに出力される。クロックがHighレベルのときSW3のスイッチがOFF、SW4のスイッチがONとなり、下の信号源（100 [Hz]の正弦波）がVoutに出力される。このように、順番に複数のチャンネルの信号を切り替えて標本化回路に出力し、順番に標本化している。

### **2.4 標本化回路（サンプル&ホールド回路）**

アナログ信号をある時間間隔でサンプリングし、次のタイミングまでその値を保持する回路である。回路図を図4に示す。

図4において、U1のクロックパルスがHighレベルになったタイミングでSW1がONになる。SW1がONになると、変調波（入力信号, SW1の下にある信号源のマーク）が回路に入力されるようになる。回路に入った信号の電圧はコンデンサC1を充電し、C1の電圧は入力信号の瞬時値と同じ値になる。その後、コンデンサC1の電圧は右のオペアンプで構成されるバッファ回路（ボルテージフォロワのような原理）を通って、同じ電圧でVoutに出力される（場合によっては増幅器を挟む場合もあるが、今回は利得は0dB）。クロックパルスU1がLowレベルになってSW1がOFFになっても、C1の電圧は充電電圧のまま保たれてオペアンプに入力されてVoutの出力は一定になる。これは、オペアンプの入力インピーダンスが非常に高く、C1から電荷がほとんど出ていかないためである。Voutの出力を保っている間に、Voutの出力はA/Dコンバータに入力されて二進数に変換される。A/D変換が終わった後にまたU1がHighになり入力信号の瞬時値がサンプリングされ、その値をホールドしA/D変換をするということを繰り返すことで入力信号がデジタル信号に変換される。

なお、図4にはR1の抵抗がつけられているが、回路の安定性のためのものである。R1は1 [MΩ]という非常に大きな値なので、理論上では開放と考えてもよい。開放と考えるとよくあるボルテージフォロワ回路と同じ回路になる。試しにR1を取り外してシミュレーションをした結果が図5であるが、波形は変わらない。

### **2.5 シフトレジスタ（パラレルシリアル変換）**

8ビット並列に入ってきた信号を直列にして1つずつ送信する回路である。回路図を図6に示す。

U17~U24までには、本来はA/D変換されて並列に送られてきたデジタル信号の二進数が入力されるが、今回の実験では代わりにスイッチを前段に設けている。T3がONになったタイミングでデジタル信号がシフトレジスタU25 74199に入力される。シフトレジスタではパラレルに送られてきた信号を順番に出力してシリアル信号にしてClockのタイミングでOUTPUTに出力する。

### **2.6 波形合成・分離回路**

実際の装置では、データとチャンネル信号を合成しているが、本実験ではその代わりにclock回路の出力T2とT3を用いてこの回路の動作を理解する。回路図を図7に示す。

T3の波形を反転させるためにIdeal inverterを使う。Ideal inverterの出力とT2をIdeal adderを使い加算する。その波形はVmix端子に出力される。

合成した波形は、理想ダイオード2つと反転増幅器を用いた分離回路で元の波形に戻す。ここで、理想ダイオードによる分離回路について説明する。図7の等価回路を図8に示す。Vmixが0VのときはV1の5 [V]によってダイオードが導通するので、VT2とVT3の電圧は図8(b)と(c)のようにただの導線の電圧を測っていることになり、電圧は0 [V]が出力される。

Vmixが5 [V]のときは上のダイオードがOFF、下のダイオードが反転増幅回路を通ることによってONになるので、(e)のようにVT3に-5 [V]が出力される。実際の回路ではオペアンプの回路で反転されるので、5 [V]が出力される。

Vmixが-5 [V]のときは上のダイオードがON、下のダイオードが反転増幅回路を通ることによってOFFになるので、(f)のようにVT2に-5 [V]が出力される。実際の回路ではオペアンプの回路で反転されるので、5 [V]が出力される。

このように、Ideal adderで合成されたVmixの波形は分離回路によってT2由来の信号がVT3に、T3由来の信号がVT2にそれぞれプラスの電圧で出力され、分離できたという状態になる。

### **2.7 AD-DA変換回路、ローパスフィルタ**

図9に回路図を示す。VG1より交流Vm=5V, f=500Hzを供給する。ADコンバータU10は負の電圧は変換できないのでIdeal adderで6Vを加え全体が正の電圧になるようにシフトアップする。

U4 74199はラッチといい、クロックT2の負電圧のタイミングで取り込み、正の電圧の区間値を保持している。

AD変換されたデータは再びDAコンバータMV95308に入力しアナログ値に戻す。ADコンバータ側で6Vシフトアップしてあるので、DAコンバータの出力からIdeal subtracterで6Vを差し引く。

電圧ピンVDAの波形は、階段状の波形なので、ローパスフィルタを通し、滑らかな波形とする。

## **3 実験方法**

図2中のクロックと電圧ピンを取り去り、そこに「特殊」タブにあるマクロピンを接続した。図10に図2を変更した回路を示す。図10の回路をマクロ化（1チップ化）した。「ツール」中の新規マクロ・ウィザードでマクロ化し、回路図に読み込み（「挿入」->「マクロ」）、この回路を保存した。

図2から図9まで（図5, 図8を除く）の各機能ブロックごとにシミュレータで作成し、「解析」->「過渡解析」を実行して波形を観測した。

なお、図6のシフトレジスタについては、入力のHLスイッチの値を変えて、OUTPUTの波形がどのようになるか確認した。

## **4 使用機器**

本実験では、シミュレーションソフト「TINA-TI」を用いた。TINAはDesignSoftの製品であり、TEXAS INSTRUMENTS社専用で、無償で提供されている。

## **5 実験結果及び考察**

### **5.1 タイミングパルス発生回路**

図2のタイミングパルス発生回路を作成して過渡現象のシミュレーションを実行した結果を図11に示す。図11の結果より、T1は、RCOが出力されるタイミングで反転している。また、さっき示した図2の回路の真理値表通りに動作しているので、理論通りであるといえる。

### **5.2 切替回路**

図12に図3の切替回路を組んで過渡現象をシミュレーションした結果を示す。
Voutを見ると、Vclockのタイミングで100 [Hz]の信号と50 [Hz]の信号が交互に出力されていることがわかる。したがって、理論通りであるといえる。

### **5.3 標本化回路（サンプル&ホールド回路）**

図13に図4の標本化回路を組んで過渡現象シミュレーションを実行した結果を示す。
Voutの波形を見ると、Vclockの立ち上がりのタイミングでVG1の電圧になっており、Vclockが0になってSW1がOFFになってからも電圧が維持されていることがわかる。したがって、理論通りであるといえる。

### **5.4 シフトレジスタ（パラレルシリアル変換）**

図14に図6のシフトレジスタを組んでシミュレーションした過渡現象を示す。パラレル信号はSW-HL1, SW-HL6, SW-HL7, SW-HL8をHighとし、それ以外をLowとした。OUTPUTを見ると、T3が出力された後に、High, High, High, Low, Low, Low, Low, Highが出力されており、SW-HL8から順番にパラレル信号が出力されている。したがって、理論通りであるといえる。

### **5.5 波形合成・分離回路**

図15に図7の波形合成・分離回路を組んで過渡現象をシミュレーションした結果を示す。
Vmixを見ると、T2の波形はプラスで、T3の波形はマイナスで合成されている。また、VT2にはT3と同じ形状の波形が、VT3にはT2と同じ形状の波形が出力されている。なお、VT2とVT3の波形は振幅が5.00 [V]になっている。したがって、理論通りである。

### **5.6 AD-DA変換回路、ローパスフィルタ**

図16に図9のAD-DA変換回路、ローパスフィルタを組んで過渡現象をシミュレーションした結果を示す。
Vinを見ると、VG1の波形が+6 [V]上にシフトされていることがわかる。したがって、理論通りであるといえる。
VDAは、U1 74199でAD変換された信号をMV95308でアナログ信号に戻してV1で加えた6 [V]分を引いた後の波形である。振幅値をカーソルを当てて調べると、T2のクロックごとに振幅の値が変化している。したがって、T2のタイミングで入力されているデジタル信号に対応した電圧を出力しているので、理論通りであるといえる。
VQAとVQHについては、VG1の値が変化するごとに0 [V]と4 [V]のどちらかに変化している。したがって、理論通りである。
V復調を見ると、VDAではT2のクロックごとに変化していた振幅が連続的に変化するようになった。また、最大振幅は-0.07 [V]を中心にとると5.00 [V]である。よって、理論通りである。

## **6 報告事項**

### **(1) 標本化定理（サンプリング定理）について述べる。**

標本化（sampling）とは、音声や画像信号などの入力連続信号を一定周期Tで抽出することをいう。連続信号を$g(t)$とすると、抽出された信号の振幅は入力信号の標本点$nT$の振幅$g(nT)$に等しく、標本値といわれる。したがって、標本値よりなるパルス列$\sum_{n=-\infty}^{\infty}g(nT)$は、パルス振幅変調信号（PAM信号）を表している。

連続信号$g(t)$は帯域が$0 \sim f_0/2$に制限されているとし、標本化周期$T = 1/f_0$で標本化すると、PAMパルス列は$g(t)$とは以下の式(1)のようにあらわせる。

$$ 
 g(t) = \sum_{n=-\infty}^{\infty} g(nT) \frac{\sin \pi f_0(t - nT)}{\pi f_0 (t - nT)} \quad (1) 
 $$

この関係は、染谷―Shannonの標本化定理と呼ばれている。つまり、アナログ信号に含まれる最高周波数が$f_m$であるとき、標本化周波数が$2f_m$以上あれば、標本化されたパルス波から、元のアナログ信号を再現できるということを示している（例えば、アナログ信号の最高周波数が4 [kHz]であれば、標本化周波数は8 [kHz]でよいことになる。）[2]。

この式の持つ物理的意味を説明する。いま入力信号$g(t)$を無限小のパルス幅のインパルス$\delta(t)$の列で標本化すると、標本化パルス列は、

$$ 
 g_T(t) = \sum_{n=-\infty}^{\infty} g(nT) \cdot \delta(t - nT) \quad (2) 
 $$

であり、図17(b)のようにあらわせる。これをインパルス応答$h_s(t)$が、

$$ 
 h_s(t) = \frac{\sin \pi f_0 t}{\pi f_0 t} \quad (3) 
 $$

で表されるフィルタに通すと、その出力信号$y(t)$は、

$$ 
 y(t) = \int_{-\infty}^{\infty} g_T(\tau) h_s(t-\tau)d\tau = \sum_{n=-\infty}^{\infty} g(nT) h_s(t - nT) \quad (4) 
 $$

となり、式(1)で表される元の波形$g(t)$と等しくなる。すなわち、標本化された信号$g_T(t)$は、式(3)の補間フィルタ$h_s(t)$によって元の連続信号に復調することができるということである。

$h_s(t)$は標本化関数、または、補間関数といわれ、そのインパルス応答は、図17(c)に示すように$t = 0$ [s]で1、ほかの標本点$nT$で0になる関数である。

したがって、インパルス列$g(0), g(1T), g(2T), \cdots$に対するフィルタの応答波形は、図17(c), (d), (e)に示すように、$h_s(t)$をTずつ時間的にずらした波形に標本値振幅を掛け合わせたものになる。各標本値に対するこのような応答波形をすべて総和したものが、最終的な補間・復調された波形で、図17(f)のように連続波形に合成される。[1]

### **(2) 本実験における量子化レベルはいくらかを報告する。**

量子化とは、標本化が時間的に離散的な信号抽出をするのに対し、振幅軸方向で離散的な値をとることである。[3]
本実験では、アナログ信号を8桁の2進数に変換している。したがって、量子化ビット数は8である。8ビット符号化の場合は$2^8$の出力レベル数があり、256ステップで表現されている。

### **(3) 理想ダイオードとはどういうものかを報告する。**

通常のシリコンのダイオードでは順方向降下電圧があるので、それ以上の電圧を加えないと電流が流れ始めない。一方で、理想ダイオードは順方向電圧では短絡、逆方向電圧では解放である特性を持つ。[4]

### **(4) 図9のローパスフィルタの遮断周波数はいくらかを報告する。[5], [6]**

図9のローパスフィルタ（LPF）はサレン・キー型LPFと呼ばれるもので、オペアンプと抵抗R、コンデンサCで構成されている2次LPFである。入力電圧VINの低周波成分を通過させ、高周波成分を遮断する。

図18のサレン・キー型LPFの伝達関数を求める。一般的な2次LPFの伝達関数$G(s)$は次式で表される。

$$ G(s) = \frac{V_{OUT}}{V_{IN}} = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2} = \frac{\omega_n^2}{s^2 + \frac{\omega_n}{Q}s + \omega_n^2} \quad (16) 
 $$

ここで、$\omega_n$は固有角周波数、$\zeta$は減衰係数、Qは共振の鋭さを表すQ値である。
サレン・キー型LPFの場合、これらのパラメータは以下のようになる。

$$ 
\omega_n = \frac{1}{\sqrt{R_1 R_2 C_1 C_2}} \quad (18) 
 $$

$$ 
\zeta = \frac{R_1+R_2}{2} \sqrt{\frac{C_2}{C_1 R_1 R_2}} 
 $$

カットオフ周波数$f_c$は、$\omega_c = 2\pi f_c$であり、多くの場合$\omega_n$と等価として扱われる。

$$ 
f_c = \frac{1}{2\pi\sqrt{R_1 R_2 C_1 C_2}} \quad (19) 
 $$

図9の回路定数 $R_1=R_2=50$ [kΩ], $C_1=2.3$ [nF], $C_2=1.1$ [nF] を代入すると、

$$ 
f_c = \frac{1}{2\pi\sqrt{50 \cdot 10^3 \cdot 50 \cdot 10^3 \cdot 2.3 \cdot 10^{-9} \cdot 1.1 \cdot 10^{-9}}} \approx 2.0 \cdot 10^3 \text{ [Hz]} \quad (20) 
 $$

よって、求める遮断周波数は **2.0 kHz** となる。

### **(5) PCM変調がほかの変調方式に比べて優れている点を述べる。[7]**

PCM変調がほかの変調方式に比べて優れている点を以下に示す。
A) 雑音妨害に対して強い。（PCMでは再生に際して1か0かを検出すればよいからである。）
B) 雑音や漏話、ひずみが相加しない。（再生中継を行うため）
C) 多中継伝送に適している。（符号誤りとジッタの相加はあるものの、雑音や漏話、ひずみが少ないため、本質的には適している。）
D) アナログ伝送方式と異なり量子化雑音がある。
E) 伝送品質が距離や網の構成によらず、ほぼ一定で、すべての加入者に対して同一の通信品質を提供できる。（情報伝送品質はほとんど端局のみで決まるため。）
F) 安定度が極めて高く、レベル変動のない通信品質が得られる。
G) 異なる情報源の伝送に対する融通性があり、電話、テレビ信号、データ、ファックスなど、デジタル化されればほとんど区別することなく、多重化・伝送できる。
H) 異なる伝送媒体間の融通性があり、ケーブル・マイクロなどが比較的安価なインターフェイス装置で相互変換できる。
I) 伝送特性の悪い媒体や、新しい伝送媒体への適用性が大きい。
J) 高価なフィルタを必要とするアナログFDM通信に対し、PCM端局は経済的である。
K) 端局・中継器が一般的に複雑であり、PCMの初期には大きな欠点として考えられていたが、半導体素子、ICの急速な発展により、複雑さ自体は大きな問題ではなくなってきている。

### **(6) PCM通信で多重化できる理由を述べる。**

多重化伝送とは、1本のケーブルあるいは1つの無線周波数などの伝送媒体を通して、複数の情報源を伝送することをいう。多重化する方法としては、時間的に重なり合いがないように多重化する方法であるTDM（Time Division Multiplex: 時分割多重化）がある。

PCM変調で標本化をする際に、時間的に少しずつずらして標本化すると、互いに重なり合わないPAMパルス列となり、これを合成することによって時分割多重化が行われ、TDM-PAM信号が得られる。図19に、TDMの原理を示す。
受信する際は標本周期と同じタイミングで信号を受信すれば、正しく信号を受けることができる。[8]

### **(7) PCM通信はどのようなところで用いられているかを簡単に説明する。**

Bell電話研究所の研究により、1962年にT1方式が世界初の商用化されたPCM通信として登場した。日本においても戦後いち早く日本電信電話公社電気通信研究所や大学の研究機関によってPCMの研究が開始された。1965年には、24回線PCM方式が日本電信電話公社により商用化されるに至った。その後、高次群PCMの開発、マイクロPCM、同軸PCM、ミリ波・準ミリ波通信、データ端局、画像符号化、統合網、衛星通信、さらには最近の光ファイバ通信などのようにPCM技術が用いられている。[9]

### **参考文献**

[1] 金子尚志:「PCM 通信の技術」,産報出版株式会社,pp.17-19 (1977)
[2] 羽鳥光俊:「わかりやすい通信工学」,コロナ社,p.21(2012)
[3] 金子尚志:「PCM 通信の技術」,産報出版株式会社,p.27(1977)
[4] 高崎和之:「基本からわかる電子回路」,株式会社ナツメ社,pp.36-37 (2021)
[5] 「Electrical Information」,https://detail-infomation.com/sallen-key-low-pass-filter/ (2023年12月14日参照)
[6] 寺島一彦,兼重明宏:「制御工学 技術者のための、理論・設計から実装まで」,実教出版株式会社,pp.121-128 (2019)
[7] 金子尚志:「PCM 通信の技術」,産報出版株式会社,pp.14-15 (1977)
[8] 金子尚志:「PCM 通信の技術」,産報出版株式会社,pp.10-11 (1977)
[9] 金子尚志:「PCM 通信の技術」,産報出版株式会社,p.10 (1977)
